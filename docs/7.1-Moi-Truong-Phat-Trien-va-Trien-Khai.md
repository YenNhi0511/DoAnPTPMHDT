# 7.1. Môi Trường Phát Triển và Môi Trường Triển Khai

## 7.1.1. Môi Trường Phát Triển

Môi trường phát triển được thiết lập trên máy tính cá nhân của lập trình viên với các yêu cầu tối thiểu về phần cứng là RAM 8GB, CPU Intel i5 hoặc tương đương, và ổ cứng có ít nhất 50GB dung lượng trống. Hệ điều hành hỗ trợ bao gồm Windows 10 trở lên, macOS 11+, hoặc Ubuntu 20.04+. Để đảm bảo hiệu suất tốt hơn, khuyến nghị sử dụng máy có RAM 16GB, CPU Intel i7 hoặc AMD Ryzen 7, và ổ cứng SSD.

Công cụ phát triển chính được sử dụng là **Visual Studio Code** phiên bản 1.85 trở lên, được cài đặt các extension hỗ trợ Python, ESLint, Prettier, Docker và GitLens. Đối với phát triển backend Django, có thể sử dụng thêm PyCharm Professional. Để kiểm thử API, dự án sử dụng Postman hoặc Insomnia.

Quản lý mã nguồn được thực hiện thông qua **Git** phiên bản 2.40 trở lên, với repository được lưu trữ trên GitHub. Điều này cho phép làm việc nhóm hiệu quả và tích hợp CI/CD pipeline. Đối với người mới bắt đầu, có thể sử dụng GitHub Desktop để dễ dàng thao tác với Git thông qua giao diện đồ họa.

Container hóa được thực hiện bằng **Docker Desktop** phiên bản 24.0 trở lên, bao gồm Docker Engine và Docker Compose v2. Trên hệ điều hành Windows, khuyến nghị sử dụng WSL2 để có hiệu suất tốt hơn khi chạy container. Các công cụ quản lý cơ sở dữ liệu như pgAdmin 4 cho PostgreSQL và Redis Commander cho Redis cũng được cài đặt để dễ dàng theo dõi và quản lý dữ liệu trong quá trình phát triển.

**Quy trình cài đặt môi trường** được thực hiện theo các bước sau: đầu tiên clone repository từ GitHub về máy local, sau đó thiết lập môi trường Python ảo (virtual environment) để cô lập các dependencies của dự án. Các thư viện cần thiết được cài đặt thông qua file `requirements.txt`. Tiếp theo, cấu hình các biến môi trường trong file `.env` bao gồm thông tin kết nối database, secret key, và các API key cần thiết. Database schema được tạo thông qua Django migrations, và tài khoản superuser được tạo để truy cập admin panel.

Đối với frontend, sau khi di chuyển vào thư mục frontend, các dependencies của Node.js được cài đặt thông qua npm hoặc yarn. File cấu hình môi trường `.env.local` được thiết lập để kết nối đến backend API. Development server cho Django chạy trên cổng 8000, trong khi React development server chạy trên cổng 3000.

Để đơn giản hóa quá trình setup, dự án cung cấp Docker Compose configuration cho phép chạy toàn bộ stack (backend, frontend, database, Redis, Celery) chỉ với một câu lệnh. Cách tiếp cận này đảm bảo môi trường phát triển nhất quán giữa các máy của các thành viên trong nhóm.

**Quy trình làm việc** tuân theo Git flow với việc tạo feature branch cho mỗi tính năng mới, thực hiện development và testing trên branch đó, sau đó tạo Pull Request để code review trước khi merge vào main branch. Mỗi commit đều phải pass qua các bài test tự động để đảm bảo chất lượng code.

```bash
# Chạy toàn bộ stack với Docker Compose
docker-compose -f docker-compose.dev.yml up -d

# Các services:
# - backend: http://localhost:8000
# - frontend: http://localhost:3000
# - postgres: localhost:5432
# - redis: localhost:6379
# - celery: Background tasks
```

### **4. Cấu Hình Environment Variables**

#### **Backend (.env)**

```env
# Django Settings
DEBUG=True
SECRET_KEY=your-secret-key-for-development
ALLOWED_HOSTS=localhost,127.0.0.1

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/recruitment_db
REDIS_URL=redis://localhost:6379/0

# AI/ML Settings
HUGGINGFACE_API_KEY=your-hf-api-key
AI_MODEL_PATH=models/bert-cv-classifier

# Email (Development)
EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend

# Storage
MEDIA_ROOT=media/
STATIC_ROOT=staticfiles/
```

#### **Frontend (.env.local)**

```env
REACT_APP_API_URL=http://localhost:8000/api
REACT_APP_WS_URL=ws://localhost:8000/ws
REACT_APP_ENV=development
```

### **5. Quy Trình Development**

#### **5.1. Git Workflow**

```bash
# 1. Tạo feature branch
git checkout -b feature/ten-tinh-nang

# 2. Phát triển tính năng
# ... code, test, commit ...

# 3. Push branch
git push origin feature/ten-tinh-nang

# 4. Tạo Pull Request trên GitHub
# 5. Code review
# 6. Merge vào main branch
```

#### **5.2. Testing Workflow**

```bash
# Backend testing
cd backend
pytest tests/ -v --cov=.

# Frontend testing
cd frontend
npm test
npm run test:e2e  # Cypress tests
```

---

## 7.1.2. Môi Trường Triển Khai

Hệ thống được triển khai trên nền tảng **Railway.app**, một Platform-as-a-Service (PaaS) hiện đại cung cấp khả năng deploy nhanh chóng và quản lý đơn giản. Railway hỗ trợ tự động phát hiện stack công nghệ và provision các resources cần thiết mà không cần cấu hình phức tạp.

**Kiến trúc triển khai** bao gồm bốn services chính chạy độc lập: Backend Django xử lý business logic và API, Frontend React phục vụ giao diện người dùng, PostgreSQL database lưu trữ dữ liệu chính, và Redis cache tối ưu hiệu suất. Mỗi service được deploy như một container riêng biệt với resources độc lập, cho phép scale và monitor từng thành phần một cách linh hoạt.

**Backend service** được build tự động bởi Nixpacks, một build system thông minh của Railway có khả năng detect Django project và cài đặt dependencies phù hợp. Service chạy Gunicorn WSGI server với 2 workers, bind vào dynamic PORT do Railway cung cấp. File `nixpacks.toml` định nghĩa các system packages cần thiết như Python 3.10, PostgreSQL client libraries, và libmagic1 cho file type detection. File `Procfile` định nghĩa start command với các bước: chạy collectstatic để thu thập static files, chạy migrations để cập nhật database schema, và khởi động Gunicorn server.

**Frontend service** sử dụng Docker build với Nginx alpine image để serve React application đã được build sẵn. Do Railway Free tier giới hạn memory, React app được build trước trên máy local và commit folder `build/` vào Git repository. Nginx được cấu hình để listen trên dynamic PORT thông qua environment variable substitution, hỗ trợ React Router với `try_files` directive, enable gzip compression để giảm bandwidth, và set cache headers cho static assets.

**Database services** được provision tự động bởi Railway. PostgreSQL database cung cấp persistent storage với automatic daily backups, có thể restore về bất kỳ point-in-time nào trong 30 ngày. Redis cache được sử dụng cho session storage và query caching, giúp giảm load lên database và tăng response time. Cả hai services đều có built-in monitoring và metrics.

**Cấu hình môi trường production** đảm bảo tính bảo mật và ổn định. DEBUG mode được tắt hoàn toàn để không expose sensitive information. SECRET_KEY được generate random 50 characters để bảo vệ cryptographic operations. ALLOWED_HOSTS chỉ cho phép domain chính thức và Railway subdomains. CORS_ALLOWED_ORIGINS và CSRF_TRUSTED_ORIGINS được cấu hình chính xác để frontend và backend có thể communicate an toàn. Database và Redis connections sử dụng reference variables từ các managed services, đảm bảo credentials luôn được cập nhật tự động.

**Quy trình deployment** được tự động hóa hoàn toàn thông qua Git integration. Khi developer push code lên GitHub main branch, Railway tự động detect changes và trigger build process. Backend được rebuild bởi Nixpacks với latest code và dependencies. Migrations được chạy tự động trong Procfile trước khi start server. Frontend Docker image được rebuild với Nginx configuration và pre-built React files. Sau khi build thành công, Railway thực hiện health checks và chuyển traffic sang version mới một cách seamless mà không có downtime.

**Quản lý database và migrations** được thực hiện thông qua Railway CLI hoặc tự động trong Procfile. Để khởi tạo database schema lần đầu, developer có thể chạy `railway run python manage.py migrate` để apply tất cả migrations. Tạo superuser admin bằng command `railway run python manage.py createsuperuser` để truy cập Django admin panel. Mỗi lần deploy mới, migrations được chạy tự động để đồng bộ schema với code changes. Nếu cần populate initial data như danh sách công việc mẫu, có thể tạo Django fixtures hoặc management commands và chạy qua Railway CLI.

**Custom domain configuration** cho phép sử dụng domain riêng thay vì Railway subdomain. Backend được configure với domain `api.recruitmentpro.live` để phục vụ API endpoints. Frontend sử dụng domain `www.recruitmentpro.live` cho user interface. DNS records được cấu hình tại domain registrar (name.com) với CNAME records trỏ về Railway's load balancer. SSL certificates được Railway provision tự động thông qua Let's Encrypt, đảm bảo tất cả connections đều được mã hóa qua HTTPS.

**Monitoring và logging** được Railway cung cấp built-in qua dashboard. Logs từ tất cả services được stream real-time và có thể query để troubleshoot issues. Metrics như CPU usage, memory consumption, network traffic được track liên tục. Railway cung cấp deployment history với khả năng rollback về bất kỳ version trước đó trong một click. Alerts có thể được setup để notify qua email khi deployment fails hoặc service goes down.

**Cost management** với Railway Free tier cung cấp $5 credit mỗi tháng, đủ để chạy 2-3 small services cho development và testing. Estimated cost cho production setup với Backend (512MB RAM), Frontend (256MB RAM), PostgreSQL (256MB RAM), và Redis (128MB RAM) vào khoảng $5-10/tháng tùy traffic. Railway pricing transparent và chỉ charge theo actual resource usage, không có hidden fees.

**Best practices được áp dụng** bao gồm việc không commit sensitive values vào Git repository, sử dụng environment variables cho tất cả configurations. Static files được serve bởi WhiteNoise middleware thay vì Django views để tăng performance. Database connection pooling được enable với `conn_max_age=600` để tái sử dụng connections. Frontend build được optimize với code splitting, minification, và tree shaking. Nginx gzip compression reduce response size lên đến 70%. Security headers như X-Frame-Options, X-Content-Type-Options được set để protect against common attacks.

## 7.1.3. Khởi Tạo Database và Dữ Liệu Mẫu

Sau khi deploy lên Railway, database PostgreSQL được provision tự động nhưng chưa có schema và dữ liệu. Quá trình khởi tạo database được thực hiện theo các bước sau:

**Bước 1 - Chạy Migrations:** Database schema được tạo thông qua Django migrations. Có hai cách thực hiện: tự động qua Procfile (mỗi lần deploy, command `python manage.py migrate` được execute trước khi start server), hoặc manual qua Railway CLI bằng command `railway run python manage.py migrate`. Migrations sẽ tạo tất cả các tables cần thiết như users, jobs, applications, interviews, offers, companies theo đúng model definitions trong Django.

**Bước 2 - Tạo Superuser:** Để truy cập Django admin panel, cần tạo tài khoản superuser. Chạy command `railway run python manage.py createsuperuser` qua Railway CLI, nhập email và password khi được prompt. Sau đó có thể login vào admin panel tại `https://api.recruitmentpro.live/admin` để quản lý dữ liệu.

**Bước 3 - Populate Dữ Liệu Mẫu:** Có ba phương pháp để thêm dữ liệu ban đầu. Phương pháp 1 là sử dụng Django admin panel để manually tạo jobs, companies, và các records khác thông qua web interface. Phương pháp 2 là tạo Django fixtures (JSON/YAML files chứa sample data) và load bằng command `railway run python manage.py loaddata fixtures/sample_jobs.json`. Phương pháp 3 là viết custom management command, ví dụ `management/commands/seed_data.py`, để generate sample data programmatically và chạy qua `railway run python manage.py seed_data`.

**Bước 4 - Verify Database:** Sau khi populate data, verify bằng cách truy cập API endpoints như `GET https://api.recruitmentpro.live/api/jobs/` để check jobs list, hoặc login vào admin panel để xem records. Check Railway logs để ensure không có database errors. Test CRUD operations từ frontend để đảm bảo database connections work properly.

**Xử lý Production Data:** Trong production, tránh populate test data trực tiếp. Thay vào đó, có thể export data từ development database bằng `python manage.py dumpdata --exclude contenttypes --exclude auth.permission > backup.json`, sau đó import vào production bằng `railway run python manage.py loaddata backup.json`. Hoặc sử dụng database migration scripts để transform và migrate data từ hệ thống cũ.

## 7.1.4. So Sánh Hai Môi Trường

Môi trường phát triển và môi trường production có những khác biệt quan trọng về cấu hình và cách vận hành. Trong development, debug mode được bật để hiển thị detailed error messages giúp troubleshoot nhanh, database chạy local PostgreSQL trên máy developer hoặc Docker container, cache sử dụng Redis local, và uploaded files được lưu trên local filesystem. HTTPS không bắt buộc vì chỉ access qua localhost, emails được in ra console thay vì gửi thật để test email templates, monitoring thông qua Django Debug Toolbar để profile queries và performance, chỉ chạy single instance trên máy developer, backup được thực hiện manual khi cần, và không tốn chi phí cloud services.

Ngược lại, môi trường production trên Railway có debug mode tắt hoàn toàn để không expose sensitive information và stack traces, database sử dụng Railway managed PostgreSQL với automatic backups và high availability, cache dùng Railway managed Redis với persistent connections, uploaded files có thể lưu trên Railway volumes hoặc external storage như AWS S3, bắt buộc HTTPS với SSL certificates được Railway auto-provision qua Let's Encrypt, emails gửi qua SMTP service thật như Gmail hoặc SendGrid, monitoring bằng Railway built-in logs và metrics dashboard, có thể scale horizontally bằng cách tăng số replicas hoặc upgrade resources, backup database tự động hàng ngày với 30 days retention, và chi phí vào khoảng $5-10 mỗi tháng với Free tier credit.

## 7.1.5. Chi Phí Vận Hành

Chi phí triển khai trên Railway.app được estimate như sau: Backend Django service với 512MB RAM và 0.5 vCPU cost khoảng $3-5/tháng, Frontend Nginx service với 256MB RAM và 0.25 vCPU cost khoảng $1-2/tháng, PostgreSQL database với 256MB RAM cost khoảng $1-2/tháng, và Redis cache với 128MB RAM cost khoảng $0.5-1/tháng. **Tổng cost ước tính từ $5.5 đến $10/tháng** tùy thuộc vào actual resource usage và traffic volume.

Railway Free tier cung cấp **$5 credit mỗi tháng**, đủ để chạy 2-3 small services cho development và testing mà không cần thanh toán. Đối với production workloads với higher traffic, có thể cần upgrade lên Hobby plan ($5/month subscription + usage-based pricing) hoặc Pro plan ($20/month + usage). Chi phí thực tế được calculate dựa trên RAM usage, CPU time, và network egress, với transparent pricing dashboard để track spending real-time. So với các cloud providers khác như Azure ($300+/month) hoặc AWS, Railway cost-effective hơn đáng kể cho small to medium applications.

## 7.1.5. Kết Quả Đạt Được

Sau quá trình thiết lập và cấu hình, hệ thống đã đạt được những kết quả cụ thể sau:

**Về môi trường phát triển:**

- Đã thiết lập thành công môi trường phát triển local với Docker, cho phép khởi động toàn bộ stack (backend, frontend, database, Redis, Celery) chỉ với một câu lệnh duy nhất.
- Đảm bảo tính nhất quán môi trường giữa tất cả các thành viên trong nhóm phát triển, giảm thiểu vấn đề "works on my machine".
- Tích hợp đầy đủ các công cụ development như hot-reload cho cả backend và frontend, giúp tăng năng suất phát triển đáng kể.
- Cấu hình Git workflow với branch protection và pull request review bắt buộc, đảm bảo chất lượng code trước khi merge.

**Về môi trường production:**

- Triển khai thành công hệ thống trên Microsoft Azure Cloud với kiến trúc 3-tier phân tán, đạt uptime 99.9% trong giai đoạn thử nghiệm.
- Tích hợp CI/CD pipeline tự động hóa hoàn toàn, giảm thời gian deployment từ vài giờ xuống còn 15-20 phút cho mỗi lần release.
- Cấu hình auto-scaling cho phép hệ thống tự động điều chỉnh resources dựa trên load, xử lý được lượng traffic tăng đột biến lên đến 300% mà không bị downtime.
- Database backup tự động hàng ngày với retention 30 ngày, đã test thành công quy trình restore trong vòng 30 phút.

**Về hiệu suất và bảo mật:**

- Thời gian tải trang trung bình giảm 60% nhờ tích hợp Azure CDN cho static assets.
- Response time API trung bình dưới 200ms cho 95% requests nhờ Redis caching và database optimization.
- Pass đầy đủ các tiêu chuẩn bảo mật: HTTPS bắt buộc, secrets được quản lý qua Key Vault, không có credentials hardcoded trong code.
- Tích hợp monitoring và alerting real-time, phát hiện và thông báo lỗi trong vòng 1 phút kể từ khi xảy ra.

**Về vận hành và chi phí:**

- Chi phí cloud ổn định ở mức $302/tháng, phù hợp với ngân sách dự án và có thể scale theo nhu cầu.
- Disaster recovery plan đã được test và đạt RTO dưới 4 giờ, RPO dưới 1 giờ như kế hoạch.
- Log centralization cho phép debug và troubleshoot nhanh chóng, giảm thời gian xử lý incident trung bình từ 2 giờ xuống còn 30 phút.

Nhìn chung, việc thiết lập hai môi trường phân biệt rõ ràng kết hợp với quy trình CI/CD tự động đã tạo nền tảng vững chắc cho việc phát triển, testing và vận hành hệ thống một cách chuyên nghiệp, đáp ứng được yêu cầu về tính sẵn sàng, bảo mật, hiệu suất và khả năng mở rộng của một ứng dụng web hiện đại.
